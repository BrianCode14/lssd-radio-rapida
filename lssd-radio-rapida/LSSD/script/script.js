const palabrasClavePorSeccion = {

    //! LSPD
  "Informe": [
    "#LSSD CC to LSPD: Informamos ingreso a su jurisdiccion por una persecucion activa, no se requiere apoyo.",
  ],

  "Mutual uno LSPD": [
    "#LSSD CC to LSPD: Se solicita apoyo para una persecucion activa en curso, sintonizar mutual uno.",
  ],
  "Mutual dos LSPD": [
    "#LSSD CC to LSPD: Se solicita apoyo para una persecucion activa en curso, sintonizar mutual dos.",
  ],
  "Mutual tres LSPD": [
    "#LSSD CC to LSPD: Se solicita apoyo para una persecucion activa en curso, sintonizar mutual tres.",
  ],
  "Mutual cuatro LSPD": [
    "#LSSD CC to LSPD: Se solicita apoyo para una persecucion activa en curso, sintonizar mutual cuatro.",
  ],
  "Mutual cinco LSPD": [
    "#LSSD CC to LSPD: Se solicita apoyo para una persecucion activa en curso, sintonizar mutual cinco.",
  ],
  "Mutual seis LSPD": [
    "#LSSD CC to LSPD: Se solicita apoyo para una persecucion activa en curso, sintonizar mutual seis.",
  ],

  "Mutual uno LSPD emboscada": [
    "#LSSD CC to LSPD: Se solicita apoyo por una emboscada activa en curso, sintonizar mutual uno.",
  ],
  "Mutual dos LSPD": [
    "#LSSD CC to LSPD: Se solicita apoyo por una emboscada activa en curso, sintonizar mutual dos.",
  ],
  "Mutual tres LSPD": [
    "#LSSD CC to LSPD: Se solicita apoyo por una emboscada activa en curso, sintonizar mutual tres.",
  ],
  "Mutual cuatro LSPD": [
    "#LSSD CC to LSPD: Se solicita apoyo por una emboscada activa en curso, sintonizar mutual cuatro.",
  ],
  "Mutual cinco LSPD": [
    "#LSSD CC to LSPD: Se solicita apoyo por una emboscada activa en curso, sintonizar mutual cinco.",
  ],
  "Mutual seis LSPD": [
    "#LSSD CC to LSPD: Se solicita apoyo por una emboscada activa en curso, sintonizar mutual seis.",
  ],
    //! LSPD

    //! USMS
  "Mutual uno USMS": [
    "#LSSD CC to USMS: Se solicita apoyo para [SITUACION], sintonizar mutual uno.",
  ],
  "Mutual dos USMS": [
    "#LSSD CC to USMS: Se solicita apoyo para [SITUACION], sintonizar mutual dos.",
  ],
  "Mutual tres USMS": [
    "#LSSD CC to USMS: Se solicita apoyo para [SITUACION], sintonizar mutual tres.",
  ],
  "Mutual cuatro USMS": [
    "#LSSD CC to USMS: Se solicita apoyo para [SITUACION], sintonizar mutual cuatro.",
  ],
  "Mutual cinco USMS": [
    "#LSSD CC to USMS: Se solicita apoyo para [SITUACION], sintonizar mutual cinco.",
  ],
  "Mutual seis USMS": [
    "#LSSD CC to USMS: Se solicita apoyo para [SITUACION], sintonizar mutual seis.",
  ],
    //! USMS

    //! SPS
  "Mutual uno SPS": [
    "#LSSD CC to SPS: Se solicita apoyo para [SITUACION], sintonizar mutual uno.",
  ],
  "Mutual dos SPS": [
    "#LSSD CC to SPS: Se solicita apoyo para [SITUACION], sintonizar mutual dos.",
  ],
  "Mutual tres SPS": [
    "#LSSD CC to SPS: Se solicita apoyo para [SITUACION], sintonizar mutual tres.",
  ],
  "Mutual cuatro SPS": [
    "#LSSD CC to SPS: Se solicita apoyo para [SITUACION], sintonizar mutual cuatro.",
  ],
  "Mutual cinco SPS": [
    "#LSSD CC to SPS: Se solicita apoyo para [SITUACION], sintonizar mutual cinco.",
  ],
  "Mutual seis SPS": [
    "#LSSD CC to SPS: Se solicita apoyo para [SITUACION], sintonizar mutual seis.",
  ],
    //! SPS

    //! FIB
  "FIB": [
    "#LSSD CC to FIB: Se solicita una unidad federal sobre [UBICACION] por [SITUACION] para imputacion de cargos federales.",
  ],


  "Mutual uno FIB": [
    "#LSSD CC to FIB: Se solicita apoyo para [SITUACION], sintonizar mutual uno.",
  ],
  "Mutual dos FIB": [
    "#LSSD CC to FIB: Se solicita apoyo para [SITUACION], sintonizar mutual dos.",
  ],
  "Mutual tres FIB": [
    "#LSSD CC to FIB: Se solicita apoyo para [SITUACION], sintonizar mutual tres.",
  ],
  "Mutual cuatro FIB": [
    "#LSSD CC to FIB: Se solicita apoyo para [SITUACION], sintonizar mutual cuatro.",
  ],
  "Mutual cinco FIB": [
    "#LSSD CC to FIB: Se solicita apoyo para [SITUACION], sintonizar mutual cinco.",
  ],
  "Mutual seis FIB": [
    "#LSSD CC to FIB: Se solicita apoyo para [SITUACION], sintonizar mutual seis.",
  ],
    //! FIB

        //! USSS
  "Mutual uno USSS": [
    "#LSSD CC to USSS: Se solicita apoyo para [SITUACION], sintonizar mutual uno.",
  ],
  "Mutual dos USSS": [
    "#LSSD CC to USSS: Se solicita apoyo para [SITUACION], sintonizar mutual dos.",
  ],
  "Mutual tres USSS": [
    "#LSSD CC to USSS: Se solicita apoyo para [SITUACION], sintonizar mutual tres.",
  ],
  "Mutual cuatro USSS": [
    "#LSSD CC to USSS: Se solicita apoyo para [SITUACION], sintonizar mutual cuatro.",
  ],
  "Mutual cinco USSS": [
    "#LSSD CC to USSS: Se solicita apoyo para [SITUACION], sintonizar mutual cinco.",
  ],
  "Mutual seis USSS": [
    "#LSSD CC to USSS: Se solicita apoyo para [SITUACION], sintonizar mutual seis.",
  ],
    //! USSS
        //! LSAF
  "Mutual uno LSAF": [
    "#LSSD CC to LSAF: Se solicita apoyo para una emboscada masiva, sintonizar mutual uno.",
  ],
  "Mutual dos LSAF": [
    "#LSSD CC to LSAF: Se solicita apoyo para una emboscada masiva, sintonizar mutual dos.",
  ],
  "Mutual tres LSAF": [
    "#LSSD CC to LSAF: Se solicita apoyo para una emboscada masiva, sintonizar mutual tres.",
  ],
  "Mutual cuatro LSAF": [
    "#LSSD CC to LSAF: Se solicita apoyo para una emboscada masiva, sintonizar mutual cuatro.",
  ],
  "Mutual cinco LSAF": [
    "#LSSD CC to LSAF: Se solicita apoyo para una emboscada masiva, sintonizar mutual cinco.",
  ],
  "Mutual seis LSAF": [
    "#LSSD CC to LSAF: Se solicita apoyo para una emboscada masiva, sintonizar mutual seis.",
  ],
    //! LSAF

    //! LSES
  "Medicos": [
    "#LSSD CC to LSES: Se solicita una unidad medica sobre [UBICACION] por [SITUACION].",
  ],
    //! LSES

    //! raw
  "Raw": [
    "/do La ambulancia llega al lugar, y los paramédicos descienden rápidamente del vehículo, trayendo consigo un maletín de primeros auxilios. Uno de ellos se arrodilla junto al herido, revisando sus signos vitales con rapidez y precisión. Comenzando procedimiento de primeros auxilios. ¿Los paramedios pudieron auxiliarlo?"
  ],
    //! raw

    //! unidad volcada
    "Unidad volcada": [
    "Un Fire Engine del departamento de bomberos del condado acude a la escena del accidente. El escuadrón rápidamente realiza un rescate técnico para retirar al uniformado de la unidad volcada, posteriormente aseguran la zona para poder retirar el vehículo y trasladar al herido mediante ambulancia al centro médico más cercano."
  ],
  //!uniad volcada

  //! bluecheck
  "Bluecheck": [
    "/me Saca el dispositivo bluecheck y toma los dedos de #hash para asi tomarle las huellas dactilares. Luego, presiona el botón de escanear y espera a que el dispositivo procese la información.",
  ],

    "Bluecheck resultado": [
        "/do De ser posible, que datos arrojaria #hash? Nombre y Apellido / Edad / Nacionalidad / Residencia / Estatura."
    ],
    //! bluecheck

    //! arresto
    "Arresto estacion": [
        "/do Despues de un rato se verian llegar un equipo del US Marshall, los cuales trasladarian al sujeto a la prision local. Luego de unos dias de espera pasaria por un juicio rapido y seria condenado, siendo derivado a la prision federal."
    ],
    //! arresto

    //! T-Stop
    "T-Stop": [
        "![Unidad], código 6 por un t-stop sobre un [Modelo] [Color] [Ocupantes], matricula [N° de matrícula), en [Calle], [Zona].",
    ],
    //! T-Stop

    //! informe crimen
    "Informe crimen": [
        "![unidad],SCC, 10-34 para informe de crimen, darme el parche.",
        "![Texto], Tiro el parche.",
    ],
    //! informe crimen

    //! Derechos
    "Derechos": [
        "Tiene derecho a guardar silencio, todo lo que diga podrá ser utilizado en su contra en un tribunal de justicia de Los Santos, tiene derecho a un abogado siempre y cuando vaya usted a ser interrogado, por último, tiene derecho a una llamada telefónica de una duración no mayor a 5 minutos en presencia de un agente de la ley. ¿Ha entendido sus derechos?",
    ],
    //! Derechos
    
    //! codigo 4
  "Codigo cuatro tactico uno": [
    "!288 Sam, SCC, código cuatro en tactico uno, sin requerir apoyo adicional."],

  "Codigo cuatro tactico dos": [
    "!288 Sam, SCC, código cuatro en tactico dos, sin requerir apoyo adicional.",
  ],
  "Codigo cuatro tactico tres": [
    "!288 Sam, SCC, código cuatro en tactico tres, sin requerir apoyo adicional.",
  ],
  "Codigo cuatro tactico cuatro": [
    "!288 Sam, SCC, código cuatro en tactico cuatro, sin requerir apoyo adicional.",
  ],
  "Codigo cuatro tactico cinco": [
    "!288 Sam, SCC, código cuatro en tactico cinco, sin requerir apoyo adicional.",
  ],
  "Codigo cuatro tactico seis": [
    "!288 Sam, SCC, código cuatro en tactico seis, sin requerir apoyo adicional."
  ],

  "Codigo cuatro mutual uno": [
    "!288 Sam, SCC, código cuatro en mutual uno, sin requerir apoyo adicional."],

  "Codigo cuatro mutual dos": [
    "!288 Sam, SCC, código cuatro en mutual dos, sin requerir apoyo adicional.",
  ],

  "Codigo cuatro mutual tres": [
    "!288 Sam, SCC, código cuatro en mutual tres, sin requerir apoyo adicional.",
  ],

  "Codigo cuatro mutual cuatro": [
    "!288 Sam, SCC, código cuatro en mutual cuatro, sin requerir apoyo adicional.",
  ],

  "Codigo cuatro mutual cinco": [
    "!288 Sam, SCC, código cuatro en mutual cinco, sin requerir apoyo adicional.",
  ],
  "Codigo cuatro mutual seis": [
    "!288 Sam, SCC, código cuatro en mutual seis, sin requerir apoyo adicional."
  ]
    //! codigo 4

};

document.querySelector('.formulario').addEventListener('submit', function(e) {
  e.preventDefault();
  const palabraInput = document.querySelector('input[name="palabra"]').value.trim().toLowerCase();
  const container = document.querySelector('.container');

  // Elimina modals anteriores
  document.querySelectorAll('.modal-resultado-dinamico').forEach(modal => modal.remove());

  if (palabraInput === "") {
    crearModal("Por favor, ingresa una palabra, letra o sección a buscar.", "#dc3545", container, []);
    return;
  }

  let encontrado = false;

  // Buscar si el input es el nombre de una sección
  for (const [seccion, palabras] of Object.entries(palabrasClavePorSeccion)) {
    if (seccion.toLowerCase() === palabraInput) {
      encontrado = true;
      crearModal(
        `<b>${seccion}</b><br>${palabras.map(r => `<div>${r}</div>`).join('')}`,
        "#198754",
        container,
        palabras // Solo palabras, sin el título
      );
      break;
    }
  }

  // Si no es una sección, buscar coincidencias en todas las palabras
  if (!encontrado) {
    for (const [seccion, palabras] of Object.entries(palabrasClavePorSeccion)) {
      const resultados = palabras.filter(palabra => palabra.toLowerCase().includes(palabraInput));
      if (resultados.length > 0) {
        encontrado = true;
        crearModal(
          `<b>${seccion}</b><br>${resultados.map(r => `<div>${r}</div>`).join('')}`,
          "#198754",
          container,
          resultados // Solo resultados, sin el título
        );
      }
    }
  }

  if (!encontrado) {
    crearModal("No se encontró ninguna coincidencia.", "#dc3545", container, []);
  }
});

// Función para crear un modal dinámico
function crearModal(html, color, container, palabrasACopiar) {
  const modal = document.createElement('div');
  modal.className = 'modal-resultado-dinamico';
  modal.style.cssText = `
    margin: 32px auto 0;
    max-width: 480px;
    background: linear-gradient(135deg, #232946 60%, #1a1a2e 100%);
    border-radius: 14px;
    box-shadow: 0 8px 32px 0 rgba(31,38,135,0.25);
    padding: 2rem 2rem 1.5rem 2rem;
    text-align: left;
    font-size: 1.08rem;
    color: #f4f4f4;
    border: 1.5px solid #2d3250;
    position: relative;
    animation: modalFadeIn 0.3s;
  `;

  // Animación para el modal
  const style = document.createElement('style');
  style.innerHTML = `
    @keyframes modalFadeIn {
      from { opacity: 0; transform: translateY(30px);}
      to { opacity: 1; transform: translateY(0);}
    }
    .modal-resultado-dinamico b {
      color: ${color};
      font-size: 1.13rem;
      letter-spacing: 0.5px;
      font-weight: 600;
      display: block;
      margin-bottom: 0.7rem;
    }
    .modal-resultado-dinamico div:not(:last-child) {
      margin-bottom: 0.5rem;
    }
    .modal-resultado-dinamico button:focus {
      outline: 2px solid #3386ff;
      outline-offset: 2px;
    }
    .modal-resultado-dinamico button:hover {
      filter: brightness(1.08);
      transform: translateY(-2px) scale(1.03);
      box-shadow: 0 2px 8px rgba(51,134,255,0.08);
    }
  `;
  document.head.appendChild(style);

  const resultadoDiv = document.createElement('div');
  resultadoDiv.innerHTML = html;

  const btnsDiv = document.createElement('div');
  btnsDiv.style.cssText = `
    margin-top: 1.3rem;
    display: flex;
    gap: 14px;
    justify-content: flex-end;
  `;

  const btnCopiar = document.createElement('button');
  btnCopiar.textContent = "Copiar";
  btnCopiar.style.cssText = `
    padding: 0.5rem 1.3rem;
    border-radius: 6px;
    border: none;
    background: linear-gradient(90deg, #3386ff 70%, #4f8cff 100%);
    color: #fff;
    font-weight: 500;
    font-size: 1rem;
    cursor: pointer;
    transition: all 0.15s;
    box-shadow: 0 1px 4px rgba(51,134,255,0.10);
  `;
  btnCopiar.onclick = () => {
    if (palabrasACopiar && palabrasACopiar.length > 0) {
      navigator.clipboard.writeText(palabrasACopiar.join('\n'));
    } else {
      navigator.clipboard.writeText(resultadoDiv.innerText);
    }
    btnCopiar.textContent = "¡Copiado!";
    setTimeout(() => btnCopiar.textContent = "Copiar", 1200);
  };

  const btnEliminar = document.createElement('button');
  btnEliminar.textContent = "Eliminar";
  btnEliminar.style.cssText = `
    padding: 0.5rem 1.3rem;
    border-radius: 6px;
    border: none;
    background: linear-gradient(90deg, #dc3545 70%, #ff5b6b 100%);
    color: #fff;
    font-weight: 500;
    font-size: 1rem;
    cursor: pointer;
    transition: all 0.15s;
    box-shadow: 0 1px 4px rgba(220,53,69,0.10);
  `;
  btnEliminar.onclick = () => modal.remove();

  btnsDiv.appendChild(btnCopiar);
  btnsDiv.appendChild(btnEliminar);

  modal.appendChild(resultadoDiv);
  modal.appendChild(btnsDiv);

  container.appendChild(modal);
}

      // Generar dinámicamente los títulos desde el objeto principal
      const palabrasClaveTitulos = Object.keys(palabrasClavePorSeccion);

      document.getElementById('ver-palabras-btn').onclick = function() {
        let lista = document.getElementById('lista-palabras');
        lista.innerHTML = palabrasClaveTitulos.length
          ? palabrasClaveTitulos.map(p => `<li><span class="palabra-titulo">${p}</span></li>`).join('')
          : '<li>No hay palabras clave agregadas.</li>';
        document.getElementById('modal-palabras').style.display = 'flex';
      };
      document.getElementById('cerrar-modal-palabras').onclick = function() {
        document.getElementById('modal-palabras').style.display = 'none';
      };

      // Mejorar el CSS del modal y lista para scroll y estética
      window.addEventListener('DOMContentLoaded', function() {
        // Modal fondo
        const modalPalabras = document.getElementById('modal-palabras');
        modalPalabras.style.display = 'none';
        modalPalabras.style.position = 'fixed';
        modalPalabras.style.top = '0';
        modalPalabras.style.left = '0';
        modalPalabras.style.width = '100vw';
        modalPalabras.style.height = '100vh';
        modalPalabras.style.background = 'rgba(30,34,60,0.55)';
        modalPalabras.style.zIndex = '1000';
        modalPalabras.style.justifyContent = 'center';
        modalPalabras.style.alignItems = 'center';

        // Modal contenido
        const modalContent = modalPalabras.querySelector('div');
        modalContent.style.background = 'linear-gradient(135deg, #232946 60%, #1a1a2e 100%)';
        modalContent.style.borderRadius = '18px';
        modalContent.style.padding = '2.2rem 2.5rem 2rem 2.5rem';
        modalContent.style.minWidth = '320px';
        modalContent.style.maxWidth = '95vw';
        modalContent.style.boxShadow = '0 8px 32px 0 rgba(31,38,135,0.25)';
        modalContent.style.position = 'relative';
        modalContent.style.color = '#f4f4f4';
        modalContent.style.maxHeight = '82vh';
        modalContent.style.overflow = 'hidden';
        modalContent.style.display = 'flex';
        modalContent.style.flexDirection = 'column';

        // Lista scrollable
        const listaPalabras = document.getElementById('lista-palabras');
        listaPalabras.style.textAlign = 'left';
        listaPalabras.style.marginBottom = '1.7rem';
        listaPalabras.style.maxHeight = '54vh';
        listaPalabras.style.overflowY = 'auto';
        listaPalabras.style.paddingRight = '8px';
        listaPalabras.style.listStyle = 'none';
        listaPalabras.style.paddingLeft = '0';

        // Mejorar la barra de scroll solo en la lista
        listaPalabras.style.scrollbarWidth = 'thin';
        listaPalabras.style.scrollbarColor = '#3386ff #232946';

        // Botón cerrar
        const btnCerrar = document.getElementById('cerrar-modal-palabras');
        btnCerrar.style.position = 'absolute';
        btnCerrar.style.top = '18px';
        btnCerrar.style.right = '32px'; // <-- Cambiado de 22px a 32px para más separación
        btnCerrar.style.background = 'none';
        btnCerrar.style.border = 'none';
        btnCerrar.style.color = '#fff';
        btnCerrar.style.fontSize = '1.5rem';
        btnCerrar.style.cursor = 'pointer';
        btnCerrar.style.transition = 'color 0.2s';
        btnCerrar.onmouseover = () => btnCerrar.style.color = '#ff5b6b';
        btnCerrar.onmouseout = () => btnCerrar.style.color = '#fff';

        // Agregar estilos adicionales con CSS-in-JS
        const style = document.createElement('style');
        style.innerHTML = `
          #modal-palabras li {
        margin-bottom: 0.45rem;
        padding: 0.5rem 0.7rem;
        border-radius: 7px;
        transition: background 0.15s;
        font-size: 1.07rem;
        letter-spacing: 0.2px;
        cursor: pointer;
          }
          #modal-palabras li:hover {
        background: rgba(51,134,255,0.12);
          }
          .palabra-titulo {
        font-weight: 600;
        color: #3386ff;
        text-shadow: 0 1px 2px #1a1a2e33;
        font-size: 1.09rem;
        letter-spacing: 0.3px;
          }
          #modal-palabras::-webkit-scrollbar,
          #lista-palabras::-webkit-scrollbar {
        width: 7px;
        background: #232946;
        border-radius: 6px;
          }
          #modal-palabras::-webkit-scrollbar-thumb,
          #lista-palabras::-webkit-scrollbar-thumb {
        background: #3386ff;
        border-radius: 6px;
          }
        `;
        document.head.appendChild(style);
      });
